

<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Contribuer à Zeste de Savoir &mdash; Documentation Zeste de Savoir dev</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="Workflow et détails pratiques" href="workflow.html" />
    <link rel="prev" title="Installation et utilisation de zmarkdown" href="install/extra-zmd.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Zeste de Savoir
          

          
          </a>

          
            
            
              <div class="version">
                dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="guides.html">Guides pas-à-pas</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Contribuer à Zeste de Savoir</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#avant-de-commencer">Avant de commencer…</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Contribuer à Zeste De Savoir</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quelques-bonnes-pratiques">Quelques bonnes pratiques</a></li>
<li class="toctree-l2"><a class="reference internal" href="#les-bonnes-pratiques-pour-les-pr-et-les-commits">Les bonnes pratiques pour les PR et les commits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#les-pull-requests">Les Pull Requests</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mise-a-jour-d-une-pull-request-rebase">Mise à jour d’une Pull Request : <em>rebase</em></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#les-commits">Les commits</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html"><em>Workflow</em> et détails pratiques</a></li>
<li class="toctree-l1"><a class="reference internal" href="back-end.html">Le <em>back-end</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="back-end-code.html">Documentation technique du <em>back-end</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="front-end.html">Le <em>front-end</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Makefile et autres outils</a></li>
<li class="toctree-l1"><a class="reference internal" href="delay-issue.html">Problème de lenteur lors du dev ?</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Zeste de Savoir</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Contribuer à Zeste de Savoir</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/contributing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="contribuer-a-zeste-de-savoir">
<h1>Contribuer à Zeste de Savoir<a class="headerlink" href="#contribuer-a-zeste-de-savoir" title="Lien permanent vers ce titre">¶</a></h1>
<div class="section" id="avant-de-commencer">
<h2>Avant de commencer…<a class="headerlink" href="#avant-de-commencer" title="Lien permanent vers ce titre">¶</a></h2>
<ol class="arabic simple">
<li><p>Vérifiez que vous avez <a class="reference external" href="https://github.com/signup/free">un compte Github</a>.</p></li>
<li><dl class="simple">
<dt>Créez le <em>ticket</em> correspondant à votre travail s’il n’existe pas. (Cette étape peut être omise pour des corrections mineures.)</dt><dd><ul class="simple">
<li><p>Vérifiez que vous avez la dernière version du code.</p></li>
<li><p>Décrivez clairement votre problème, avec toutes les étapes pour le reproduire.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><strong>Attribuez-vous</strong> votre <em>ticket</em>. C’est important pour éviter de se marcher dessus. Si vous n’êtes pas dans l’organisation et donc que vous ne pouvez pas vous attribuer directement le <em>ticket</em>, ajoutez simplement un commentaire clair dans celui-ci (tel que <em>« Je prends »</em>).</p></li>
<li><p><em>Forkez</em> le dépôt et installez l’environnement, <a class="reference external" href="./install.html">comme décrit ici</a>.</p></li>
</ol>
</div>
<div class="section" id="id1">
<h2>Contribuer à Zeste De Savoir<a class="headerlink" href="#id1" title="Lien permanent vers ce titre">¶</a></h2>
<ol class="arabic simple">
<li><p>Créez une branche pour contenir votre travail.</p></li>
<li><p>Faites vos modifications.</p></li>
<li><p>Ajoutez un test pour votre modification. Seules les modifications de documentation et les réusinages n’ont pas besoin de nouveaux tests.</p></li>
<li><p>Assurez-vous que vos tests passent en utilisant la commande <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">test</span></code> (<a class="reference external" href="https://docs.djangoproject.com/fr/1.10/topics/testing/overview/#running-tests">voir la documentation</a>). Lancer la commande sur tous les tests du site risque de prendre un certain temps et n’est pas nécessaire : les tests seront de toute manière lancés de manière automatisée sur votre <em>pull request</em>.</p></li>
<li><p>Assurez-vous que le code suit la <a class="reference external" href="http://legacy.python.org/dev/peps/pep-0008/">PEP-8</a> : <code class="docutils literal notranslate"><span class="pre">flake8</span></code>.</p></li>
<li><p>Si vous avez fait des modifications du _frontend_, jouez les tests associés : <code class="docutils literal notranslate"><span class="pre">yarn</span> <span class="pre">test</span></code>.</p></li>
<li><p>Si vous modifiez les modèles (les fichiers <code class="docutils literal notranslate"><span class="pre">models.py</span></code>), n’oubliez pas de créer les fichiers de migration : <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">makemigrations</span></code>.</p></li>
<li><p>Poussez votre travail et faites une <em>pull request</em>.</p></li>
<li><p>Si votre travail nécessite des actions spécifiques lors du déploiement, précisez-les dans le corps de votre <em>pull request</em>. Elles seront ajoutées au <em>changelog</em> par le mainteneur qui effectuera le <em>merge</em>.</p></li>
</ol>
</div>
<div class="section" id="quelques-bonnes-pratiques">
<h2>Quelques bonnes pratiques<a class="headerlink" href="#quelques-bonnes-pratiques" title="Lien permanent vers ce titre">¶</a></h2>
<ul class="simple">
<li><p>Respectez <a class="reference external" href="https://docs.djangoproject.com/en/2.1/internals/contributing/writing-code/coding-style/">les conventions de code de Django</a>, ce qui inclut la <a class="reference external" href="http://legacy.python.org/dev/peps/pep-0008/">PEP 8 de Python</a>.</p></li>
<li><p>Le code et les commentaires sont en anglais.</p></li>
<li><dl class="simple">
<dt>Le <em>workflow</em> Git utilisé est le <a class="reference external" href="http://nvie.com/posts/a-successful-git-branching-model/">Git flow</a>, qui est <a class="reference external" href="./workflow.html">détaillé ici</a>. En résumé :</dt><dd><ul>
<li><p>Les arrivées fonctionnalités et corrections de gros bugs hors release se font via des PR.</p></li>
<li><p>Ces PR sont unitaires. Aucune PR qui corrige plusieurs problèmes ou apporte plusieurs fonctionnalité ne sera accepté ; la règle est : une fonctionnalité ou une correction = une PR.</p></li>
<li><p>Ces PR sont mergées dans la branche <code class="docutils literal notranslate"><span class="pre">dev</span></code> (appelée <code class="docutils literal notranslate"><span class="pre">develop</span></code> dans le git flow standard), après une QA légère.</p></li>
<li><p>Pensez à préfixer vos branches selon l’objet de votre PR : <code class="docutils literal notranslate"><span class="pre">hotfix-XXX</span></code>, <code class="docutils literal notranslate"><span class="pre">feature-XXX</span></code>, etc.</p></li>
<li><p>La branche <code class="docutils literal notranslate"><span class="pre">prod</span></code> (appelée <code class="docutils literal notranslate"><span class="pre">master</span></code> dans le git flow standard) contient exclusivement le code en production, pas la peine d’essayer de faire le moindre <em>commit</em> dessus !</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Faites des messages de <em>commit</em> clairs et en français.</p></li>
<li><p>Il n’y a aucune chance que votre <em>pull request</em> soit acceptée sans son test associé.</p></li>
<li><p>Votre test doit échouer sans votre modification, et réussir avec.</p></li>
</ul>
</div>
<div class="section" id="les-bonnes-pratiques-pour-les-pr-et-les-commits">
<h2>Les bonnes pratiques pour les PR et les commits<a class="headerlink" href="#les-bonnes-pratiques-pour-les-pr-et-les-commits" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="les-pull-requests">
<h3>Les Pull Requests<a class="headerlink" href="#les-pull-requests" title="Lien permanent vers ce titre">¶</a></h3>
<p>Lors de l’ouverture d’une PR, la zone de texte sera pré-complété avec les informations essentielles à apporter à votre PR. Utilisez ce gabarit pour rédiger votre message.</p>
<div class="line-block">
<div class="line">Ajoutez des notes de QA (Quality Assurance). Ces notes doivent permettent à un testeur de comprendre ce que vous avez modifié, ce qu’il faut tester en priorité et les pièges auxquels il doit s’attendre et donc sur lesquels porter une attention particulière.</div>
<div class="line">Précisez tout particulièrement s’il est nécessaire d’effectuer une action de gestion préalable, comme <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">migrate</span> <span class="pre">--fake-initial</span></code>, <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">loaddata</span> <span class="pre">fixture/*.yaml</span></code> ou <code class="docutils literal notranslate"><span class="pre">yarn</span> <span class="pre">run</span> <span class="pre">build</span></code>.</div>
</div>
<div class="section" id="mise-a-jour-d-une-pull-request-rebase">
<h4>Mise à jour d’une Pull Request : <em>rebase</em><a class="headerlink" href="#mise-a-jour-d-une-pull-request-rebase" title="Lien permanent vers ce titre">¶</a></h4>
<p>Au fil de l’avancement de votre PR, ou juste avant de la fusionner, il peut vous être demandé de <em>rebaser</em> (ou <em>rebase</em>). Cela permet de mettre à jour la branche de votre PR avec la toute dernière version de la branche principale du dépôt.</p>
<p>C’est une opération assez simple, et très utile pour s’assurer que votre modification s’intègre toujours bien avec la toute dernière version du site (si d’autres contributeurs ont changé quelque chose, typiquement). Elle a l’avantage, par rapport à une classique fusion (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span></code>), d’intégrer les commits naturellement dans l’historique, sans en ajouter de supplémentaire inutile.</p>
<p>Pour <em>rebase</em> en ligne de commande, utilisez la commande <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">--rebase</span> <span class="pre">upstream</span> <span class="pre">dev</span></code> (c’est tout). Si vous utilisez une interface graphique pour git, la marche à suivre dépendra de cette interface.</p>
<div class="admonition warning">
<p class="admonition-title">Avertissement</p>
<p>Si git vous informe qu’il y a <strong>des conflits</strong> lors du <em>rebase</em>, cela signifie que des parties du code ont été modifiées à la fois par les autres contributeurs et par vous-même. Pas de panique ! Corriger un conflit est assez simple. Git va, pour chaque conflit, vous montrer votre version et la version des autres contributeurs côte à côte dans le fichier concerné, et ce sera à vous de décider ce que vous gardez (votre version, celle des autres, ou un savant mélange des deux). Concrètement, pour chacun des fichiers que git indique comme en conflit, vous devez :</p>
<ol class="arabic simple">
<li><p>ouvrir le fichier, chercher les marques qu’a laissé git à l’intérieur, et résoudre le conflit en choisissant quel bout garder (tout en retirant les marques de conflit de git — à la fin, le fichier doit être “normal”, comme si git n’était jamais passé par là) ;</p></li>
<li><p>marquer les conflits du fichier comme corrigés (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">&lt;path&gt;</span></code> en ligne de commande, et probablement quelque chose comme “Marquer comme résolu” en GUI) ;</p></li>
<li><p>continuer le <em>rebase</em> (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span> <span class="pre">--continue</span></code> en ligne de commande, “Continuer le rebase” ou similaire en GUI).</p></li>
</ol>
</div>
<p>Vous devez ensuite publier sur GitHub avec un <strong>force-push</strong> (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">--force</span></code>), car <em>rebase</em> réécrit l’historique (si vous oubliez, vous obtiendrez une erreur et git refusera l’opération). Ça ne pose aucun problème ici — c’est l’un des cas d’usage légitime du <em>force-push</em>, et vous ne le faites que sur votre propre branche.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pour pouvoir <em>rebaser</em>, il vous faut avoir défini une <em>remote</em> <code class="docutils literal notranslate"><span class="pre">upstream</span></code> pointant vers le dépôt principal de ZdS (la <em>remote</em> <code class="docutils literal notranslate"><span class="pre">origin</span></code> devant pointer vers votre fork), de la façon suivante : <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">add</span> <span class="pre">upstream</span> <span class="pre">https://github.com/zestedesavoir/zds-site.git</span></code>.</p>
<p>Cette opération n’est nécessaire qu’une seule fois au début, pour tous les <em>rebases</em> que vous ferez sur votre fork.</p>
</div>
<p>Il est également possible de mettre la branche à jour sur GitHub en bas de la page de la PR, mais GitHub créé un commit de fusion sans faire de <em>rebase</em>.</p>
</div>
</div>
<div class="section" id="les-commits">
<h3>Les commits<a class="headerlink" href="#les-commits" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour les commits, nous suivons le même ordre d’idée que les standards Git.</p>
<ul class="simple">
<li><p>La première ligne du commit ne doit pas faire plus de 50 caractères.</p></li>
<li><p>Si besoin, complétez votre commit via des commentaires, en respectant une limite de 70 caractères par ligne.</p></li>
<li><p>Bien que le code soit en anglais, le commit doit être de préférence en français.</p></li>
<li><p>Vous pouvez également (c’est d’ailleurs conseillé) référencer l”<em>issue</em> que vous corrigez.</p></li>
<li><p>Un commit doit être atomique ; il fixe / implémente <strong>une</strong> chose et le fait <strong>bien</strong>.</p></li>
</ul>
<p>N’hésitez pas à demander de l’aide, et bon courage !</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="workflow.html" class="btn btn-neutral float-right" title="Workflow et détails pratiques" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install/extra-zmd.html" class="btn btn-neutral float-left" title="Installation et utilisation de zmarkdown" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2014-2020, Zeste de Savoir

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>